{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useLocation}from\"react-router-dom\";import'bootstrap/dist/css/bootstrap.min.css';import CustomCardResult from\"./CustomCardResult.jsx\";import Loading from\"./loading.jsx\";import'./home.css';import axios from\"axios\";import Genres from\"./genres.json\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CLIENT_ID=\"5d8c84c59ac8435e91aa1c9d5d2e9706\";const CLIENT_SECRET=\"93799cce40b641bb951a9b6966e3f2c0\";function Home(){const[userData,setUserData]=useState(null);const[accessToken,setAccessToken]=useState(\"\");const[newReleaseResults,setNewReleaseResults]=useState({});const[loading,setLoading]=useState(true);const[genres,setGenres]=useState([]);const spotifyEndpoints='https://api.spotify.com/v1/browse/new-releases?offset=0';function shuffleArray(array){for(let i=array.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]];}console.log(array);return array;}useEffect(()=>{// Make an API call to fetch user data from the backend\naxios.get(\"http://localhost:3000/session\").then(response=>{// Handle successful response\nsetUserData(response.data);// Assuming the response contains user data\n}).catch(error=>{// Handle error\nconsole.error(\"Error fetching user data:\",error);});async function fetchData(){// Fetch access token once during component initialization\nconst token=await fetchAccessToken();setAccessToken(token);// Fetch album data\nconst newReleases=await performSearch(token,spotifyEndpoints);setNewReleaseResults(newReleases);setLoading(false);// Set loading to false when data is loaded\n}setGenres(shuffleArray(Genres));fetchData();},[]);async function fetchAccessToken(){const authParameters={method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:'grant_type=client_credentials&client_id='+CLIENT_ID+'&client_secret='+CLIENT_SECRET};const data=await fetch('https://accounts.spotify.com/api/token',authParameters).then(result=>result.json());return data.access_token;}async function performSearch(token){let spotifyEndpoint=arguments.length>1&&arguments[1]!==undefined?arguments[1]:spotifyEndpoints;const searchParameters={method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token}};try{const response=await fetch(spotifyEndpoint,searchParameters);if(response.ok){return await response.json();}console.log(response);}catch(error){console.error('Error searching:',error);}return{};}return/*#__PURE__*/_jsx(\"div\",{className:\"background\",children:/*#__PURE__*/_jsx(\"div\",{className:\"homepage\",style:{color:'white'},children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(Loading,{})}):/*#__PURE__*/_jsxs(\"div\",{className:\"search-results\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:userData?/*#__PURE__*/_jsxs(\"p\",{className:\"caption profile-captionn\",children:[\"Welcome \",userData.username]}):/*#__PURE__*/_jsx(\"p\",{className:\"caption profile-caption\",children:\"Hello, welcome to Harmony!\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"New releases\"})}),/*#__PURE__*/_jsx(CustomCardResult,{items:newReleaseResults.albums.items.slice(0,6),subtitleType:\"album\",singleRow:true}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"Explore genres\"})}),/*#__PURE__*/_jsx(CustomCardResult,{items:genres.slice(0,6),subtitleType:\"album\",singleRow:true})]})})});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","useLocation","CustomCardResult","Loading","axios","Genres","jsx","_jsx","jsxs","_jsxs","CLIENT_ID","CLIENT_SECRET","Home","userData","setUserData","accessToken","setAccessToken","newReleaseResults","setNewReleaseResults","loading","setLoading","genres","setGenres","spotifyEndpoints","shuffleArray","array","i","length","j","Math","floor","random","console","log","get","then","response","data","catch","error","fetchData","token","fetchAccessToken","newReleases","performSearch","authParameters","method","headers","body","fetch","result","json","access_token","spotifyEndpoint","arguments","undefined","searchParameters","ok","className","children","style","color","username","items","albums","slice","subtitleType","singleRow"],"sources":["C:/Users/luker/SeniorProject/senior-music-project/frontend/src/Components/home-page/home.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport CustomCardResult from \"./CustomCardResult.jsx\";\r\nimport Loading from \"./loading.jsx\"\r\nimport './home.css'\r\nimport axios from \"axios\"\r\nimport Genres from \"./genres.json\";\r\n\r\n\r\nconst CLIENT_ID = \"5d8c84c59ac8435e91aa1c9d5d2e9706\";\r\nconst CLIENT_SECRET = \"93799cce40b641bb951a9b6966e3f2c0\";\r\n\r\nfunction Home() {\r\n    const [userData, setUserData] = useState(null);\r\n    const [accessToken, setAccessToken] = useState(\"\");\r\n    const [newReleaseResults, setNewReleaseResults] = useState({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [genres, setGenres] = useState([]);\r\n\r\n    \r\n    const spotifyEndpoints = 'https://api.spotify.com/v1/browse/new-releases?offset=0';\r\n\r\n    function shuffleArray(array) {\r\n        for (let i = array.length - 1; i > 0; i--) {\r\n          const j = Math.floor(Math.random() * (i + 1));\r\n          [array[i], array[j]] = [array[j], array[i]];\r\n        }\r\n        console.log(array);\r\n        return array;\r\n    }\r\n      \r\n      \r\n     \r\n\r\n\r\n    useEffect(() => {\r\n        // Make an API call to fetch user data from the backend\r\n        axios.get(\"http://localhost:3000/session\")\r\n          .then(response => {\r\n            // Handle successful response\r\n            setUserData(response.data); // Assuming the response contains user data\r\n          })\r\n          .catch(error => {\r\n            // Handle error\r\n            console.error(\"Error fetching user data:\", error);\r\n        });\r\n\r\n        async function fetchData() {\r\n            // Fetch access token once during component initialization\r\n            const token = await fetchAccessToken();\r\n            setAccessToken(token);\r\n           \r\n            // Fetch album data\r\n\r\n            const newReleases = await performSearch(token, spotifyEndpoints);\r\n            setNewReleaseResults(newReleases);\r\n            \r\n\r\n            \r\n            \r\n\r\n\r\n\r\n            \r\n\r\n            setLoading(false); // Set loading to false when data is loaded\r\n        }\r\n\r\n        setGenres(shuffleArray(Genres))\r\n\r\n        fetchData();\r\n\r\n\r\n    }, []);\r\n\r\n\r\n\r\n    async function fetchAccessToken() {\r\n        const authParameters = {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-urlencoded'\r\n            },\r\n            body: 'grant_type=client_credentials&client_id=' + CLIENT_ID + '&client_secret=' + CLIENT_SECRET\r\n        }\r\n        const data = await fetch('https://accounts.spotify.com/api/token', authParameters)\r\n            .then(result => result.json());\r\n        return data.access_token;\r\n    }\r\n\r\n    async function performSearch(token, spotifyEndpoint = spotifyEndpoints) {\r\n        const searchParameters = {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': 'Bearer ' + token\r\n            }\r\n        }\r\n\r\n        try {\r\n            const response = await fetch(spotifyEndpoint, searchParameters);\r\n            if (response.ok) {\r\n                return await response.json();\r\n                \r\n            }\r\n            console.log(response)\r\n        } catch (error) {\r\n            console.error('Error searching:', error);\r\n        }\r\n\r\n        return {};\r\n    }\r\n\r\n\r\n    return (\r\n        <div className = \"background\">\r\n            <div className=\"homepage\" style={{ color: 'white' }}>\r\n                {loading ? (\r\n                    <div className=\"caption-div\">\r\n                        <Loading/>\r\n                    </div>\r\n                ) : (\r\n                <div className=\"search-results\">\r\n\r\n                    <div className=\"caption-div\">\r\n                    {userData ? (\r\n                        <p className=\"caption profile-captionn\">Welcome {userData.username}</p>\r\n                        ) : (\r\n                        <p className=\"caption profile-caption\">Hello, welcome to Harmony!</p>\r\n                    )}\r\n                    </div>\r\n\r\n                    <div className=\"caption-div\">\r\n                        <p className=\"caption type-caption\">New releases</p>\r\n                    </div>\r\n                    <CustomCardResult items={newReleaseResults.albums.items.slice(0, 6)} subtitleType=\"album\" singleRow = {true}/>\r\n\r\n                    <div className=\"caption-div\">\r\n                        <p className=\"caption type-caption\">Explore genres</p>\r\n                    </div>\r\n                    <CustomCardResult items={genres.slice(0,6)} subtitleType=\"album\" singleRow = {true}/>\r\n\r\n                </div>\r\n                )}\r\n        \r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}