{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useLocation}from\"react-router-dom\";import'bootstrap/dist/css/bootstrap.min.css';import CustomCardResult from\"./CustomCardResult.jsx\";import Loading from\"./loading.jsx\";import'./home.css';import axios from\"axios\";import Genres from\"./genres.json\";import PitchforkArticles from'./articles.jsx';// Adjust the path accordingly\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CLIENT_ID=\"5d8c84c59ac8435e91aa1c9d5d2e9706\";const CLIENT_SECRET=\"93799cce40b641bb951a9b6966e3f2c0\";function Home(){const[userData,setUserData]=useState(null);const[accessToken,setAccessToken]=useState(\"\");const[userToken,setUserToken]=useState(\"\");const[newReleaseResults,setNewReleaseResults]=useState({});const[loading,setLoading]=useState(true);const[genres,setGenres]=useState([]);const spotifyEndpoints='https://api.spotify.com/v1/browse/new-releases?offset=0';function shuffleArray(array){for(let i=array.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]];}return array;}function get_user_token(){const hash=window.location.hash.substring(1).split('&').reduce(function(initial,item){if(item){let parts=item.split('=');initial[parts[0]]=decodeURIComponent(parts[1]);}return initial;},{});window.location.hash='';let _token=hash.access_token;return _token;}window.onload=function(){token=get_user_token();};useEffect(()=>{// Make an API call to fetch user data from the backend\naxios.get(\"http://localhost:3000/session\").then(response=>{// Handle successful response\nsetUserData(response.data);// Assuming the response contains user data\n}).catch(error=>{// Handle error\nconsole.error(\"Error fetching user data:\",error);});async function fetchData(){// Fetch access token once during component initialization\nconst token=await fetchAccessToken();setAccessToken(token);// Fetch album data\nconst newReleases=await performSearch(token,spotifyEndpoints);setNewReleaseResults(newReleases);setLoading(false);// Set loading to false when data is loaded\n}setGenres(shuffleArray(Genres.genres).slice(0,6));fetchData();},[]);async function fetchAccessToken(){const authParameters={method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:'grant_type=client_credentials&client_id='+CLIENT_ID+'&client_secret='+CLIENT_SECRET};const data=await fetch('https://accounts.spotify.com/api/token',authParameters).then(result=>result.json());return data.access_token;}async function performSearch(token){let spotifyEndpoint=arguments.length>1&&arguments[1]!==undefined?arguments[1]:spotifyEndpoints;const searchParameters={method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token}};try{const response=await fetch(spotifyEndpoint,searchParameters);if(response.ok){return await response.json();}console.log(response);}catch(error){console.error('Error searching:',error);}return{};}return/*#__PURE__*/_jsx(\"div\",{className:\"background\",children:/*#__PURE__*/_jsx(\"div\",{className:\"homepage\",style:{color:'white'},children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(Loading,{})}):/*#__PURE__*/_jsxs(\"div\",{className:\"search-results\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:userData?/*#__PURE__*/_jsxs(\"p\",{className:\"caption type-caption\",children:[\"Welcome \",userData.username]}):/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"Hello, welcome to Harmony!\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"New releases\"})}),/*#__PURE__*/_jsx(CustomCardResult,{items:newReleaseResults.albums.items.slice(0,6),subtitleType:\"album\",singleRow:true}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"Featured review\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"Explore genres\"})}),/*#__PURE__*/_jsx(CustomCardResult,{items:genres,subtitleType:\"genre\",singleRow:true}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\",children:/*#__PURE__*/_jsx(\"p\",{className:\"caption type-caption\",children:\"Browse current events\"})}),/*#__PURE__*/_jsx(PitchforkArticles,{}),/*#__PURE__*/_jsx(\"div\",{className:\"caption-div\"})]})})});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","useLocation","CustomCardResult","Loading","axios","Genres","PitchforkArticles","jsx","_jsx","jsxs","_jsxs","CLIENT_ID","CLIENT_SECRET","Home","userData","setUserData","accessToken","setAccessToken","userToken","setUserToken","newReleaseResults","setNewReleaseResults","loading","setLoading","genres","setGenres","spotifyEndpoints","shuffleArray","array","i","length","j","Math","floor","random","get_user_token","hash","window","location","substring","split","reduce","initial","item","parts","decodeURIComponent","_token","access_token","onload","token","get","then","response","data","catch","error","console","fetchData","fetchAccessToken","newReleases","performSearch","slice","authParameters","method","headers","body","fetch","result","json","spotifyEndpoint","arguments","undefined","searchParameters","ok","log","className","children","style","color","username","items","albums","subtitleType","singleRow"],"sources":["C:/Users/luker/SeniorProject/senior-music-project/frontend/src/Components/home-page/home.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport CustomCardResult from \"./CustomCardResult.jsx\";\r\nimport Loading from \"./loading.jsx\"\r\nimport './home.css'\r\nimport axios from \"axios\"\r\nimport Genres from \"./genres.json\";\r\nimport PitchforkArticles from './articles.jsx'; // Adjust the path accordingly\r\n\r\n\r\nconst CLIENT_ID = \"5d8c84c59ac8435e91aa1c9d5d2e9706\";\r\nconst CLIENT_SECRET = \"93799cce40b641bb951a9b6966e3f2c0\";\r\n\r\nfunction Home() {\r\n    const [userData, setUserData] = useState(null);\r\n    const [accessToken, setAccessToken] = useState(\"\");\r\n    const [userToken, setUserToken] = useState(\"\");\r\n    const [newReleaseResults, setNewReleaseResults] = useState({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [genres, setGenres] = useState([]);\r\n\r\n    \r\n    const spotifyEndpoints = 'https://api.spotify.com/v1/browse/new-releases?offset=0';\r\n\r\n    function shuffleArray(array) {\r\n        for (let i = array.length - 1; i > 0; i--) {\r\n          const j = Math.floor(Math.random() * (i + 1));\r\n          [array[i], array[j]] = [array[j], array[i]];\r\n        }\r\n        return array;\r\n    }\r\n\r\n    \r\n\r\n    function get_user_token() {\r\n        const hash = window.location.hash\r\n        .substring(1)\r\n        .split('&')\r\n        .reduce(function (initial, item) {\r\n          if (item) {\r\n            let parts = item.split('=');\r\n            initial[parts[0]] = decodeURIComponent(parts[1]);\r\n          }\r\n          return initial;\r\n        }, {});\r\n        window.location.hash = '';\r\n      \r\n        let _token = hash.access_token;\r\n        return _token;\r\n    }\r\n    \r\n    window.onload = function() {\r\n        token = get_user_token();\r\n    }\r\n      \r\n      \r\n     \r\n\r\n\r\n    useEffect(() => {\r\n        // Make an API call to fetch user data from the backend\r\n        axios.get(\"http://localhost:3000/session\")\r\n          .then(response => {\r\n            // Handle successful response\r\n            setUserData(response.data); // Assuming the response contains user data\r\n          })\r\n          .catch(error => {\r\n            // Handle error\r\n            console.error(\"Error fetching user data:\", error);\r\n        });\r\n\r\n        async function fetchData() {\r\n            // Fetch access token once during component initialization\r\n            const token = await fetchAccessToken();\r\n            setAccessToken(token);\r\n           \r\n            // Fetch album data\r\n\r\n            const newReleases = await performSearch(token, spotifyEndpoints);\r\n            setNewReleaseResults(newReleases);\r\n\r\n           \r\n            \r\n\r\n\r\n            \r\n            \r\n\r\n\r\n\r\n            \r\n\r\n            setLoading(false); // Set loading to false when data is loaded\r\n        }\r\n\r\n        setGenres(shuffleArray(Genres.genres).slice(0, 6));\r\n\r\n        fetchData();\r\n\r\n\r\n    }, []);\r\n\r\n\r\n\r\n    async function fetchAccessToken() {\r\n        const authParameters = {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-urlencoded'\r\n            },\r\n            body: 'grant_type=client_credentials&client_id=' + CLIENT_ID + '&client_secret=' + CLIENT_SECRET\r\n        }\r\n        const data = await fetch('https://accounts.spotify.com/api/token', authParameters)\r\n            .then(result => result.json());\r\n        return data.access_token;\r\n    }\r\n\r\n    async function performSearch(token, spotifyEndpoint = spotifyEndpoints) {\r\n        const searchParameters = {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': 'Bearer ' + token\r\n            }\r\n        }\r\n\r\n        try {\r\n            const response = await fetch(spotifyEndpoint, searchParameters);\r\n            if (response.ok) {\r\n                return await response.json();\r\n                \r\n            }\r\n            console.log(response)\r\n        } catch (error) {\r\n            console.error('Error searching:', error);\r\n        }\r\n\r\n        return {};\r\n    }\r\n\r\n\r\n    return (\r\n        <div className = \"background\">\r\n            <div className=\"homepage\" style={{ color: 'white' }}>\r\n                {loading ? (\r\n                    <div className=\"caption-div\">\r\n                        <Loading/>\r\n                    </div>\r\n                ) : (\r\n                <div className=\"search-results\">\r\n\r\n                    <div className=\"caption-div\">\r\n                    {userData ? (\r\n                        <p className=\"caption type-caption\">Welcome {userData.username}</p>\r\n                        ) : (\r\n                        <p className=\"caption type-caption\">Hello, welcome to Harmony!</p>\r\n                    )}\r\n                    </div>\r\n\r\n                    <div className=\"caption-div\">\r\n                        <p className=\"caption type-caption\">New releases</p>\r\n                    </div>\r\n                    <CustomCardResult items={newReleaseResults.albums.items.slice(0, 6)} subtitleType=\"album\" singleRow = {true}/>\r\n\r\n                    <div className=\"caption-div\">\r\n                        <p className=\"caption type-caption\">Featured review</p>\r\n                    </div>\r\n\r\n                    <div className=\"caption-div\">\r\n                        <p className=\"caption type-caption\">Explore genres</p>\r\n                    </div>\r\n                    <CustomCardResult items={genres} subtitleType=\"genre\" singleRow = {true}/>\r\n\r\n                    <div className=\"caption-div\">\r\n                        <p className=\"caption type-caption\">Browse current events</p>\r\n                    </div>\r\n                    <PitchforkArticles />\r\n\r\n                    <div className=\"caption-div\">\r\n\r\n                    </div>\r\n\r\n                </div>\r\n                )}\r\n        \r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}