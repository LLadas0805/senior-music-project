{"ast":null,"code":"import React,{useState,useEffect,useRef}from\"react\";import{scaleSequential}from'd3-scale';import{interpolateRgb}from'd3-interpolate';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const linkStyles={textDecoration:'none',// Remove underline\ncolor:'inherit'// Inherit the color from the parent\n};const CLIENT_ID=\"5d8c84c59ac8435e91aa1c9d5d2e9706\";const CLIENT_SECRET=\"93799cce40b641bb951a9b6966e3f2c0\";function UserReviewResults(_ref){let{reviews}=_ref;// Create a color scale from green to red\nconst colorScale=scaleSequential(interpolateRgb('rgb(189, 16, 16)','rgb(87, 163, 36)')).domain([0,100]);const[albumResults,setAlbumResults]=useState({});const{albumId}=reviews.albumId;// Get the albumId from the URL\nasync function fetchAlbumInfo(albumId){try{const token=await fetchAccessToken();// Fetch access token\nconst albumEndpoint=\"https://api.spotify.com/v1/albums/\".concat(albumId);const albumInfo=await performSearch(token,albumEndpoint);// Fetch album information\nreturn albumInfo;}catch(error){console.error('Error fetching album info:',error);return null;}}useEffect(()=>{async function fetchAlbumData(){const albumDataList=[];for(const review of reviews){const albumInfo=await fetchAlbumInfo(review.albumId);albumDataList.push(albumInfo);}setAlbumResults(albumDataList);// Update state with album info list\n}fetchAlbumData();},[reviews]);async function fetchAccessToken(){const authParameters={method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:'grant_type=client_credentials&client_id='+CLIENT_ID+'&client_secret='+CLIENT_SECRET};const data=await fetch('https://accounts.spotify.com/api/token',authParameters).then(result=>result.json());return data.access_token;}async function performSearch(token){let spotifyEndpoint=arguments.length>1&&arguments[1]!==undefined?arguments[1]:spotifyEndpoints;const searchParameters={method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token}};try{const response=await fetch(spotifyEndpoint,searchParameters);if(response.ok){return await response.json();}console.log(response);}catch(error){console.error('Error searching:',error);}return[];}return/*#__PURE__*/_jsxs(\"div\",{className:\"reviews-container\",children:[reviews.map((review,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"review-row\",children:[/*#__PURE__*/_jsx(\"hr\",{className:\"separator\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:albumResults[index].images[0].url,style:{width:'100px',height:'100px'}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-score review-text\",children:[/*#__PURE__*/_jsx(Link,{to:\"/user/\".concat(review.userId),style:linkStyles,children:/*#__PURE__*/_jsx(\"img\",{src:'https://cdn.discordapp.com/attachments/1098384619591696427/1185775745373573160/UserProfileIcon.png?ex=6590d6b8&is=657e61b8&hm=fcec25082158a3bd53e0e20f38f3a83c8cfdd532bd15eae8de0bcb0b94c6b984&',style:{width:'50px',height:'50px'},className:\"review-profile\"})}),/*#__PURE__*/_jsx(Link,{to:\"/user/\".concat(review.userId),style:linkStyles,children:/*#__PURE__*/_jsx(\"p\",{className:\"review-author\",children:review.username})}),/*#__PURE__*/_jsxs(\"div\",{className:\"score-container\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"score-text\",children:review.score}),/*#__PURE__*/_jsx(\"div\",{className:\"score-bar\",children:/*#__PURE__*/_jsx(\"div\",{style:{background:colorScale(review.score),width:\"\".concat(review.score,\"%\"),height:'100%'}})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"review-text\",children:review.reviewbody.trim()!==''?/*#__PURE__*/_jsx(\"p\",{children:review.reviewbody}):/*#__PURE__*/_jsx(\"p\",{children:\"No review given\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"review-date\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Reviewed on: \",new Date(review.createdAt).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})]})})]},index)),/*#__PURE__*/_jsx(\"hr\",{className:\"separator\"})]});}export default UserReviewResults;","map":{"version":3,"names":["React","useState","useEffect","useRef","scaleSequential","interpolateRgb","Link","jsx","_jsx","jsxs","_jsxs","linkStyles","textDecoration","color","CLIENT_ID","CLIENT_SECRET","UserReviewResults","_ref","reviews","colorScale","domain","albumResults","setAlbumResults","albumId","fetchAlbumInfo","token","fetchAccessToken","albumEndpoint","concat","albumInfo","performSearch","error","console","fetchAlbumData","albumDataList","review","push","authParameters","method","headers","body","data","fetch","then","result","json","access_token","spotifyEndpoint","arguments","length","undefined","spotifyEndpoints","searchParameters","response","ok","log","className","children","map","index","src","images","url","style","width","height","to","userId","username","score","background","reviewbody","trim","Date","createdAt","toLocaleDateString","year","month","day"],"sources":["C:/Users/luker/SeniorProject/senior-music-project/frontend/src/Components/home-page/user-review-results.jsx"],"sourcesContent":["\r\nimport React, { useState, useEffect, useRef  } from \"react\";\r\nimport { scaleSequential } from 'd3-scale';\r\nimport { interpolateRgb } from 'd3-interpolate';\r\nimport { Link  } from 'react-router-dom';\r\n\r\n\r\nconst linkStyles = {\r\n  textDecoration: 'none', // Remove underline\r\n  color: 'inherit', // Inherit the color from the parent\r\n};\r\n\r\nconst CLIENT_ID = \"5d8c84c59ac8435e91aa1c9d5d2e9706\";\r\nconst CLIENT_SECRET = \"93799cce40b641bb951a9b6966e3f2c0\";\r\n\r\n\r\nfunction UserReviewResults({ reviews }) {\r\n  // Create a color scale from green to red\r\n  const colorScale = scaleSequential(interpolateRgb('rgb(189, 16, 16)', 'rgb(87, 163, 36)')).domain([0, 100]);\r\n\r\n  const [albumResults, setAlbumResults] = useState({});\r\n \r\n  const { albumId } = reviews.albumId // Get the albumId from the URL\r\n\r\n\r\n\r\n  async function fetchAlbumInfo(albumId) {\r\n    try {\r\n      const token = await fetchAccessToken(); // Fetch access token\r\n      const albumEndpoint = `https://api.spotify.com/v1/albums/${albumId}`;\r\n      const albumInfo = await performSearch(token, albumEndpoint); // Fetch album information\r\n      return albumInfo;\r\n    } catch (error) {\r\n      console.error('Error fetching album info:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    async function fetchAlbumData() {\r\n      const albumDataList = [];\r\n      for (const review of reviews) {\r\n        const albumInfo = await fetchAlbumInfo(review.albumId);\r\n        albumDataList.push(albumInfo);\r\n      }\r\n      setAlbumResults(albumDataList); // Update state with album info list\r\n    }\r\n\r\n    fetchAlbumData();\r\n  }, [reviews]);\r\n\r\n\r\n\r\n  async function fetchAccessToken() {\r\n    const authParameters = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n        },\r\n        body: 'grant_type=client_credentials&client_id=' + CLIENT_ID + '&client_secret=' + CLIENT_SECRET\r\n    }\r\n    const data = await fetch('https://accounts.spotify.com/api/token', authParameters)\r\n        .then(result => result.json());\r\n    return data.access_token;\r\n  }\r\n\r\n  async function performSearch(token, spotifyEndpoint = spotifyEndpoints) {\r\n    const searchParameters = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': 'Bearer ' + token\r\n        }\r\n    }\r\n\r\n    try {\r\n        const response = await fetch(spotifyEndpoint, searchParameters);\r\n        if (response.ok) {\r\n            return await response.json();\r\n            \r\n        }\r\n        console.log(response)\r\n    } catch (error) {\r\n        console.error('Error searching:', error);\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"reviews-container\">\r\n     \r\n      {reviews.map((review, index) => (\r\n        \r\n       \r\n        <div key={index} className=\"review-row\">\r\n          <hr className=\"separator\" />\r\n          <div>\r\n            <img src = {albumResults[index].images[0].url}\r\n                  style={{ width: '100px', height: '100px' }}\r\n                  \r\n              />\r\n          </div>\r\n          <div className=\"user-score review-text\">\r\n            {/* Username */}\r\n            <Link to={`/user/${review.userId}`} style={linkStyles}>\r\n              <img src = {'https://cdn.discordapp.com/attachments/1098384619591696427/1185775745373573160/UserProfileIcon.png?ex=6590d6b8&is=657e61b8&hm=fcec25082158a3bd53e0e20f38f3a83c8cfdd532bd15eae8de0bcb0b94c6b984&'}\r\n                  style={{ width: '50px', height: '50px' }}\r\n                  className = 'review-profile'\r\n              />\r\n            </Link>\r\n            \r\n            <Link to={`/user/${review.userId}`} style={linkStyles}>\r\n              <p className = \"review-author\">{review.username}</p>\r\n            </Link>\r\n         \r\n            {/* Score and colored bar */}\r\n            <div className=\"score-container\">\r\n\r\n              \r\n              <p className = \"score-text\">{review.score}</p>\r\n              <div className=\"score-bar\">\r\n                \r\n                <div\r\n                  style={{\r\n                    background: colorScale(review.score),\r\n                    width: `${review.score}%`,\r\n                    height: '100%',\r\n                  }}\r\n                ></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {/* Review body */}\r\n          <div className=\"review-text\">\r\n            {review.reviewbody.trim() !== '' ? (\r\n              <p>{review.reviewbody}</p>\r\n            ) : (\r\n              <p>No review given</p>\r\n            )}\r\n            \r\n          </div>\r\n\r\n          <div className=\"review-date\">\r\n          \r\n            <p>\r\n                Reviewed on: {new Date(review.createdAt).toLocaleDateString('en-US', {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric'\r\n              })}\r\n            </p>\r\n          \r\n        </div>\r\n\r\n          \r\n        </div>\r\n      ))}\r\n      <hr className=\"separator\" />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserReviewResults;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}